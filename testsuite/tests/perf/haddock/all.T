test('haddock.base',
     [unless(in_tree_compiler(), skip)
     ,stats_num_field('peak_megabytes_allocated',
          [(wordsize(64), 323, 10)
            # 2012-08-14: 240 (amd64/Linux)
            # 2012-09-18: 237 (amd64/Linux)
            # 2012-11-12: 249 (amd64/Linux)
            # 2013-01-29: 274 (amd64/Linux)
            # 2013-10-18: 323 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 163, 10)
            # 2013-02-10:                     133 (x86/Windows)
            # 2013-11-13:                     163 (x86/Windows, 64bit machine)
          ,(wordsize(32), 156, 1)])
            # 2012-08-14: 144 (x86/OSX)
            # 2012-10-30: 113 (x86/Windows)
            # 2013-02-10: 139 (x86/OSX)
            # 2014-01-22: 168 (x86/Linux - new haddock)
            # 2014-06-29: 156 (x86/Linux)
     ,stats_num_field('max_bytes_used',
          [(wordsize(64), 115113864, 10)
            # 2012-08-14: 87374568 (amd64/Linux)
            # 2012-08-21: 86428216 (amd64/Linux)
            # 2012-09-20: 84794136 (amd64/Linux)
            # 2012-11-12: 87265136 (amd64/Linux)
            # 2013-01-29: 96022312 (amd64/Linux)
            # 2013-10-18: 115113864 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 58557136, 10)
            # 2013-02-10:                     47988488 (x86/Windows)
            # 2013-11-13:                     58557136 (x86/Windows, 64bit machine)
          ,(wordsize(32), 58243640, 1)])
            # 2013-02-10: 52237984 (x86/OSX)
            # 2014-01-22: 62189068 (x86/Linux)
            # 2014-06-29: 58243640 (x86/Linux)
     ,stats_num_field('bytes allocated',
          [(wordsize(64), 7498123680,  5)
            # 2012-08-14: 5920822352 (amd64/Linux)
            # 2012-09-20: 5829972376 (amd64/Linux)
            # 2012-10-08: 5902601224 (amd64/Linux)
            # 2013-01-17: 6064874536 (x86_64/Linux)
            # 2013-02-10: 6282746976 (x86_64/Linux)
            # 2013-09-17: 6634886456 (x86_64/Linux)
            # 2013-09-18: 6294339840 (x86_64/Linux)
            # 2013-11-21: 6756213256 (x86_64/Linux)
            # 2014-01-12: 7128342344 (x86_64/Linux)
            # 2014-06-12: 7498123680 (x86_64/Linux)
          ,(platform('i386-unknown-mingw32'), 3548581572, 5)
            # 2013-02-10:                     3358693084 (x86/Windows)
            # 2013-11-13:                     3097751052 (x86/Windows, 64bit machine)
            # 2014-04-04:                     3548581572 (x86/Windows, 64bit machine)
          ,(wordsize(32), 3799130400, 1)])
            # 2012-08-14: 3046487920 (x86/OSX)
            # 2012-10-30: 2955470952 (x86/Windows)
            # 2013-02-10: 3146596848 (x86/OSX)
            # 2014-02-22: 3554624600 (x86/Linux - new haddock)
            # 2014-06-29: 3799130400 (x86/Linux)
      ],
     stats,
     ['../../../../libraries/base/dist-install/doc/html/base/base.haddock.t'])

test('haddock.Cabal',
     [unless(in_tree_compiler(), skip)
     ,stats_num_field('peak_megabytes_allocated',
          [(wordsize(64), 309, 10)
            # 2012-08-14: 202 (amd64/Linux)
            # 2012-08-29: 211 (amd64/Linux, new codegen)
            # 2012-09-20: 227 (amd64/Linux)
            # 2012-10-08: 217 (amd64/Linux)
            # 2013-06-07: 246 (amd64/Linux) (reason unknown)
            # 2013-11-21: 269
            # 2013-11-22: 278 (amd64/Linux) (TH refactoring; weird)
	    # 2014-07-14: 309 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 144, 10)
            # 2012-10-30:                      83 (x86/Windows)
            # 2013-02-10:                     116 (x86/Windows)
            # 2013-11-13:                     129 (x86/Windows, 64bit machine)
            # 2014-01-28:                     136
            # 2014-04-04:                     144
          ,(wordsize(32), 147, 1)])
           # 2012-08-14: 116 (x86/OSX)
           # 2013-02-10:  89 (x86/Windows)
           # 2014-01-22: 139 (x86/Linux - new haddock, but out of date before)
           # 2014-06-29: 147 (x86/Linux)
     ,stats_num_field('max_bytes_used',
          [(wordsize(64), 113232208, 15)
            # 2012-08-14:  74119424 (amd64/Linux)
            # 2012-08-29:  77992512 (amd64/Linux, new codegen)
            # 2012-10-02:  91341568 (amd64/Linux)
            # 2012-10-08:  80590280 (amd64/Linux)
            # 2013-03-13:  95356616 (amd64/Linux) Cabal updated
            # 2014-07-14: 113232208 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 63493200, 15)
            # 2012-10-30: 44224896 (x86/Windows)
            # 2013-11-13: 49391436 (x86/Windows, 64bit machine)
            # 2014-04-04: 63493200 (x86/Windows, 64bit machine)
          ,(wordsize(32), 66411508, 1)])
            # 2012-08-14: 47461532 (x86/OSX)
            # 2013-02-10: 46563344 (x86/OSX)
            # 2014-01-22: 52718512 (x86/Linux)
            # 2014-06-29: 66411508 (x86/Linux)
     ,stats_num_field('bytes allocated',
          [(wordsize(64), 4200993768, 5)
            # 2012-08-14: 3255435248 (amd64/Linux)
            # 2012-08-29: 3324606664 (amd64/Linux, new codegen)
            # 2012-10-08: 3373401360 (amd64/Linux)
            # 2013-03-13: 3626604824 (amd64/Linux) Cabal updated
            # 2013-03-28: 3517301864 (amd64/Linux) fixed #7796
            # 2013-04-26: 3658801800 (amd64/Linux) Cabal updated
            # 2013-08-26: 3808466816 (amd64/Linux) Cabal updated
            # 2013-11-21: 3908586784 (amd64/Linux) Cabal updated
            # 2013-12-12: 3828567272 (amd64/Linux)
            # 2014-01-12: 3979151552 (amd64/Linux) new parser
            # 2014-06-29: 4200993768 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 2052220292, 5)
            # 2012-10-30:                     1733638168 (x86/Windows)
            # 2013-02-10:                     1906532680 (x86/Windows)
            # 2014-01-28:                     1966911336 (x86/Windows)
            # 2014-04-24:                     2052220292 (x86/Windows)
          ,(wordsize(32), 2127198484, 1)])
            # 2012-08-14: 1648610180 (x86/OSX)
            # 2014-01-22: 1986290624 (x86/Linux)
            # 2014-06-29: 2127198484 (x86/Linux)
      ],
     stats,
     ['../../../../libraries/Cabal/Cabal/dist-install/doc/html/Cabal/Cabal.haddock.t'])

test('haddock.compiler',
     [unless(in_tree_compiler(), skip)
     ,stats_num_field('peak_megabytes_allocated',
          [(wordsize(64), 1551, 10)
            # 2012-08-14: 1203 (amd64/Linux)
            # 2012-08-21: 1199 (amd64/Linux)
            # 2012-09-20: 1228 (amd64/Linux)
            # 2012-10-08: 1240 (amd64/Linux)
            # 2013-08-26: 1250 (amd64/Linux) Cabal updated
            # 2013-10-18: 1408 (amd64/Linux)
            # 2013-12-12: 1551 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 735, 10)
            # 2012-10-30:                     606 (x86/Windows)
            # 2013-02-10:                     653 (x86/Windows)
            # 2013-11-13:                     735 (x86/Windows, 64bit machine)
          ,(wordsize(32), 771, 1)])
            # 2012-08-14: 631 (x86/OSX)
            # 2013-02-10: 663 (x86/OSX)
            # 2014-01-22: 727 (x86/Linux - new haddock, but out of date before)
            # 2014-06-29: 771 (x86/Linux)
     ,stats_num_field('max_bytes_used',
          [(wordsize(64), 541926264, 10)
            # 2012-08-14: 428775544 (amd64/Linux)
            # 2012-09-20: 437618008 (amd64/Linux)
            # 2012-10-08: 442768280 (amd64/Linux)
            # 2012-11-12: 420105120 (amd64/Linux)
            # 2013-06-08: 477593712 (amd64/Linux) (reason unknown)
            # 2013-11-21: 502920176 (amd64/Linux)
            # 2013-11-22: 541926264 (amd64/Linux) (TH refactoring; weird)
          ,(platform('i386-unknown-mingw32'), 278706344, 10)
            # 2012-10-30:                     220847924 (x86/Windows)
            # 2013-02-10:                     238529512 (x86/Windows)
            # 2013-11-13:                     269147084 (x86/Windows, 64bit machine)
            # 2014-01-28:                     283814088 (x86/Windows)
            # 2014-04-04:                     278706344 (x86/Windows)
          ,(wordsize(32), 284082916, 1)])
            # 2012-08-14: 231064920 (x86/OSX)
            # 2013-02-10: 241785276 (x86/Windows)
            # 2014-01-22: 278124612 (x86/Linux - new haddock)
            # 2014-06-29: 284082916 (x86/Linux)
     ,stats_num_field('bytes allocated',
          [(wordsize(64), 29809571376, 10)
            # 2012-08-14: 26070600504 (amd64/Linux)
            # 2012-08-29: 26353100288 (amd64/Linux, new CG)
            # 2012-09-18: 26882813032 (amd64/Linux)
            # 2012-11-12: 25990254632 (amd64/Linux)
            # 2014-07-17: 29809571376 (amd64/Linux) general round of updates
	    # 2012-11-27: 28708374824 (amd64/Linux)
          ,(platform('i386-unknown-mingw32'), 14328363592, 10)
            # 2012-10-30:                     13773051312 (x86/Windows)
            # 2013-02-10:                     14925262356 (x86/Windows)
            # 2013-11-13:                     14328363592 (x86/Windows, 64bit machine)
          ,(wordsize(32), 15110426000, 1)])
            # 2012-08-14: 13471797488 (x86/OSX)
            # 2014-01-22: 14581475024 (x86/Linux - new haddock)
            # 2014-06-29: 15110426000 (x86/Linux)
      ],
     stats,
     ['../../../../compiler/stage2/doc/html/ghc/ghc.haddock.t'])
